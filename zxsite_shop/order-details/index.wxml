<view class="container" style="background-color: {{backgroundColor}}">
    <view class="sec-wrap">
        <view class="order-status">
            <view class="icon-box">
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-ddgb.png" wx:if="{{orderDetail.status==0}}"></image>
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-ddfk.png" wx:elif="{{orderDetail.status==1}}"></image>
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-ddfh.png" wx:elif="{{orderDetail.status==2}}"></image>
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-ddsh.png" wx:elif="{{orderDetail.status==3}}"></image>
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-jycg.png" wx:elif="{{orderDetail.status==4||orderDetail.status==5}}"></image>
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-groups.png" wx:elif="{{orderDetail.status==6}}"></image>
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-ddsh.png" wx:elif="{{orderDetail.status==7}}"></image>
            </view>
            <view class="right-text">
                <view class="status red" wx:if="{{orderDetail.status==0}}">已关闭</view>
                <view class="status" wx:elif="{{orderDetail.status==1}}">待付款</view>
                <view class="status" wx:elif="{{orderDetail.status==2}}">待{{orderDetail.module!='book'?'发货':'使用'}}</view>
                <view class="status" wx:elif="{{orderDetail.status==3}}">待收货</view>
                <view class="status" wx:elif="{{orderDetail.status==4}}">待评价</view>
                <view class="status red" wx:elif="{{orderDetail.status==5}}">已完成</view>
                <view class="status" wx:elif="{{orderDetail.status==6}}">拼团中</view>
                <view class="status" wx:elif="{{orderDetail.status==7&&orderDetail.refund.status==1}}">维权申请中</view>
                <view class="status red" wx:elif="{{orderDetail.status==7&&orderDetail.refund.status==2}}">维权同意</view>
                <view class="status red" wx:elif="{{orderDetail.status==7&&orderDetail.refund.status==3}}">维权拒绝</view>
            </view>
        </view>
        <view class="wuliu-box" wx:if="{{orderDetail.shipping}}">
            <view class="icon-box">
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-wuliu.png"></image>
            </view>
            <view class="right-text">
                <view class="order-number">物流：{{orderDetail.shipping}}<block wx:if="{{orderDetail.shipping_sn}}">，单号：{{orderDetail.shipping_sn}}</block>
                </view>
                <view class="wuliu-info" wx:for="{{orderDetail.logistics.data}}" wx:key="{{index}}">
                    <block wx:if="{{index==0}}">
                        <view class="wuliu-sign">
                            <view class="sign_circle_end"></view>
                        </view>
                        <view class="wuliu-text" style="color: #74ca74">{{item.station}}<view class="wuliu-date">{{item.time}}</view>
                        </view>
                    </block>
                    <block wx:else>
                        <view class="wuliu-sign">
                            <view class="sign_circle"></view>
                        </view>
                        <view class="wuliu-text">{{item.station}}<view class="wuliu-date">{{item.time}}</view>
                        </view>
                    </block>
                </view>
            </view>
        </view>
        <view class="address-sec" style="display:block" wx:if="{{orderDetail.name}}">
            <view style="display:flex">
                <view class="icon-box">
                    <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/about-telphone.png"></image>
                </view>
                <view class="right-box">
                    <view class="name-tel">{{orderDetail.name}}  {{orderDetail.mobile}}</view>
                    <view class="text">
                      {{orderDetail.address}}
                  </view>
                </view>
            </view>
            <view bindtap="onOpenStoreLoaction" style="display:flex" wx:if="{{orderDetail.shop_name}}">
                <view class="icon-box">
                    <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-address.png"></image>
                </view>
                <view class="right-box {{orderDetail.store_id?'dir':''}}">
                    <view class="name-tel">{{orderDetail.shop_name}}  {{orderDetail.shop_telphone}}</view>
                    <view class="text">
                      {{orderDetail.shop_address}}
                  </view>
                </view>
            </view>
        </view>
        <view class="address-sec" style="border-top:1rpx solid #eee;" wx:if="{{diyForm.length>0}}">
            <view class="icon-box">
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-remark.png"></image>
            </view>
            <view class="right-box">
                <view class="name-tel">{{orderDetail.module=='book'?'预约':'购买'}}信息</view>
                <block wx:for="{{diyForm}}" wx:key="key">
                    <view class="text" style="margin-bottom:20rpx;" wx:if="{{item.type=='text'}}">
                {{item.name}}：{{item.value}}
              </view>
                    <view class="text" style="margin-bottom:20rpx;display: flex;align-items: center;flex-wrap: wrap;" wx:if="{{item.type=='image'}}">
                {{item.name}}：<image bindtap="bindPreviewImage" class="img-list" data-src="{{item}}" mode="aspectFill" src="{{item}}" wx:for="{{item.item}}" wx:key="key"></image>
                    </view>
                </block>
            </view>
        </view>
        <view class="address-sec" style="border-top:1rpx solid #eee;" wx:if="{{orderDetail.remark}}">
            <view class="icon-box">
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-remark.png"></image>
            </view>
            <view class="right-box">
                <view class="name-tel">备注</view>
                <view class="text">
                  {{orderDetail.remark}}
              </view>
            </view>
        </view>
        <view class="address-sec" style="border-top:1rpx solid #eee;" wx:if="{{orderDetail.shipping_remark}}">
            <view class="icon-box">
                <image class="icon" src="http://qn.zxsite.cn/zxsite_shop/icon-remark.png"></image>
            </view>
            <view class="right-box">
                <view class="name-tel">发货备注</view>
                <view class="text">
                  {{orderDetail.shipping_remark}}
              </view>
            </view>
        </view>
    </view>
    <view class="verify-code-wrapper" wx:if="{{orderDetail.status==2&&(orderDetail.send_type==2||orderDetail.module=='book')}}">
        <view class="verify-title">核销码</view>
        <view>
            <image mode="aspectFill" src="{{orderDetail.qrcode}}"></image>
        </view>
        <view class="verify-code">{{orderDetail.verify_code}}</view>
    </view>
    <view class="goods-list">
        <view class="list-title">商品信息</view>
        <form bindsubmit="submitReputation" reportSubmit="true">
            <block wx:for="{{orderDetail.goods}}" wx:key="{{index}}">
                <view bindtap="gotoGoodsDetail" class="a-goods" data-auction="{{item.is_auction}}" data-goodsId="{{item.goods_id}}" data-groups="{{item.is_groups}}">
                    <view class="img-box">
                        <image class="img" src="{{item.cover}}"></image>
                    </view>
                    <view class="text-box">
                        <view class="arow arow01">
                            <view class="goods-name">{{item.title}}</view>
                            <view class="goods-price">¥ {{item.price}}</view>
                        </view>
                        <view class="arow">
                            <view class="goods-label">{{item.property_names}}</view>
                            <view class="goods-num">x {{item.number}}</view>
                        </view>
                    </view>
                </view>
                <view class="btn-row a-remark" style="display:block !important;font-size:28rpx;margin-left:30rpx" wx:if="{{orderDetail.status==4}}">
                    <view class="section section_gap">
                        <view style="margin-top:35rpx;margin-bottom:35rpx;">评价：</view>
                        <radio-group name="goodReputation{{index}}">
                            <label style="margin-right:35rpx;">
                                <radio checked value="2"></radio>好评</label>
                            <label style="margin-right:35rpx;">
                                <radio value="1"></radio>中评</label>
                            <label style="margin-right:35rpx;">
                                <radio value="0"></radio>差评</label>
                        </radio-group>
                    </view>
                    <view class="row-box" style="margin-top:35rpx">
                        <view class="row-label">备注</view>
                        <input name="orderGoodsId{{index}}" style="display:none" value="{{item.id}}"></input>
                        <input name="goodsId{{index}}" style="display:none;" value="{{item.goods_id}}"></input>
                        <input name="number{{index}}" style="display:none;" value="{{item.number}}"></input>
                        <input name="integralGive{{index}}" style="display:none;" value="{{item.integral_give}}"></input>
                        <textarea adjustPosition="true" focus="true" name="goodReputationContent{{index}}" placeholder="非常愉快的一次购物！" showConfirmBar="" style="margin-top:35rpx;width:100%;"></textarea>
                    </view>
                </view>
            </block>
            <view class="btn-row  btn-rows" style="display:block !important;font-size:28rpx;marign-left:30rpx" wx:if="{{orderDetail.status==4}}">
                <button class="confirm-btn order-btn" formType="submit">提交评价</button>
            </view>
        </form>
        <view class="btn-rows">
            <view class="btn-row" wx:if="{{orderDetail.status==3||orderDetail.status==2}}">
                <form bindsubmit="cancelBtnTap" reportSubmit="true" wx:if="{{orderDetail.order_refund_status==1}}">
                    <button class="fill-btn order-btn" formType="submit">取消退换</button>
                </form>
                <form bindsubmit="refundBtnTap" reportSubmit="true" wx:if="{{!orderDetail.order_refund_status}}">
                    <button class="refund-btn order-btn" formType="submit">退换</button>
                </form>
            </view>
            <view class="btn-row">
                <form bindsubmit="confirmBtnTap" reportSubmit="true" wx:if="{{orderDetail.status==3}}">
                    <button class="confirm-btn order-btn" formType="submit">确认收货</button>
                </form>
            </view>
        </view>
    </view>
    <view class="goods-info">
        <view class="row-box">
            <view class="row-label">商品金额</view>
            <view class="right-text">¥ {{orderDetail.amount}}</view>
        </view>
        <view class="row-box" wx:if="{{orderDetail.send_type==1}}">
            <view class="row-label">运费</view>
            <view class="right-text">+ ¥ {{orderDetail.freight}}</view>
        </view>
        <view class="row-box" wx:if="{{orderDetail.deduction_balance>0}}">
            <view class="row-label">抵扣余额</view>
            <view class="right-text">- ¥ {{orderDetail.deduction_balance}}</view>
        </view>
        <view class="row-box">
            <view class="row-label">应付总额</view>
            <view class="right-text">¥ {{orderDetail.pay_amount}}</view>
        </view>
    </view>
</view>
