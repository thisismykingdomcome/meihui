<view class="container" style="background-color: {{backgroundColor}}">
    <view class="tab-box" wx:if="{{isNeedLogistics}}">
        <view bindtap="bindChangeSendType" class="tab-label {{item.type==currentSendType?'active':''}}" data-type="{{item.type}}" style="border-bottom-color: {{item.type==currentSendType?themeColor:'#fff'}};color: {{item.type==currentSendType?themeColor:'#353535'}}" wx:for="{{sendType}}" wx:key="{{index}}">
            <text class="tab-text" style="border-bottom: 2px solid {{themeColor}}" wx:if="{{item.type==currentSendType}}">{{item.name}}</text>
            <text class="tab-text" wx:else>{{item.name}}</text>
        </view>
    </view>
    <view class="form-container">
        <form bindsubmit="createOrder" reportSubmit="true">
            <view class="address-box" wx:if="{{isNeedLogistics&&currentSendType==1}}">
                <view class="add-address" hidden="{{curAddressData}}">
                    <view bindtap="addAddress" class="title">新增收货地址</view>
                </view>
                <view bindtap="selectAddress" class="show-address" hidden="{{!curAddressData}}">
                    <view class="name-tel">{{curAddressData.name}}  {{curAddressData.mobile}}</view>
                    <view class="addr-text">{{curAddressData.address}}</view>
                </view>
            </view>
            <view class="address-box" wx:if="{{isNeedLogistics&&currentSendType==2||isBook}}">
                <view class="add-address" wx:if="{{!shopStore.name||!shopStore.telephone||!shopStore.address}}">
                    <view bindtap="onShopStoreTap" class="title">选择取货门店</view>
                </view>
                <view bindtap="onShopStoreTap" class="show-address" wx:else>
                    <view class="name-tel">{{shopStore.name}}  {{shopStore.telephone}}</view>
                    <view class="addr-text">{{shopStore.address}}</view>
                </view>
            </view>
            <view class="peisong-way" wx:if="{{isNeedLogistics&&currentSendType==2||isBook}}">
                <view class="row-box">
                    <view class="row-label">姓名</view>
                    <view class="right-text">
                        <input class="liuyan" name="name" placeholder="请输入姓名" type="text" value="{{name}}"></input>
                    </view>
                </view>
                <view class="row-box">
                    <view class="row-label">电话</view>
                    <view class="right-text">
                        <input class="liuyan" name="mobile" placeholder="请输入电话" type="text" value="{{mobile}}"></input>
                    </view>
                </view>
            </view>
            <view class="peisong-way" wx:if="{{isNeedLogistics&&currentSendType==1&&settings.city_express_enabled==1}}">
                <view bindtap="onCityExpressAreaTap" class="row-box coupon" style="border-bottom:none;">
                    <view style="background: url(http://qn.zxsite.cn/zxsite_shop/icon-city-express.png) no-repeat left center;background-size: 40rpx auto;padding-left: 50rpx;">本单支持同城配送</view>
                </view>
            </view>
            <view class="goods-list">
                <view class="list-title">商品列表</view>
                <view class="a-goods" wx:for="{{goodsList}}" wx:key="{{index}}">
                    <view class="img-box">
                        <image class="img" src="{{item.cover}}"></image>
                    </view>
                    <view class="text-box">
                        <view class="arow arow01">
                            <view class="goods-name">{{item.title}}</view>
                            <view class="goods-price">¥ {{item.price}}</view>
                        </view>
                        <view class="arow">
                            <view class="goods-label">{{item.propertyNames}}</view>
                            <view class="goods-num">x {{item.number}}</view>
                        </view>
                    </view>
                </view>
            </view>
            <view class="peisong-way">
                <picker bindchange="bindChangePayType" class="row-box coupon" range="{{payTypeList}}" rangeKey="name" style="border-bottom:none;" value="{{selPayTypeIndex}}">
                    <view class="picker">
                        <view>{{selPayType}}</view>
                    </view>
                </picker>
            </view>
            <view class="peisong-way">
                <view class="row-box" wx:if="{{isNeedLogistics&&currentSendType==1}}">
                    <view class="row-label">配送方式</view>
                    <view class="right-text" wx:if="{{deliveryType==0}}">无</view>
                    <view class="right-text" wx:if="{{deliveryType==1}}">快递</view>
                    <view class="right-text" wx:if="{{deliveryType==2}}">同城</view>
                </view>
                <view class="row-box" wx:if="{{isNeedLogistics&&currentSendType==2}}">
                    <view class="row-label">配送方式</view>
                    <view class="right-text">自提</view>
                </view>
                <view class="row-box">
                    <view class="row-label">备注</view>
                    <view class="right-text">
                        <input class="liuyan" name="remark" placeholder="如需备注请输入" type="text"></input>
                    </view>
                </view>
            </view>
            <view class="peisong-way" wx:if="{{hasCoupon}}">
                <picker bindchange="bindChangeCoupon" class="row-box coupon" range="{{couponList}}" rangeKey="name" style="border-bottom:none;" value="{{selCouponIndex}}">
                    <view class="picker">
                        <view>{{selCoupon}}</view>
                        <view class="number">{{couponCount}}</view>
                    </view>
                </picker>
            </view>
            <view class="goods-info" wx:if="{{isNeedLogistics&&freightPrice>0||selCouponIndex>0||deductionBalance>0}}">
                <view class="row-box" wx:if="{{isNeedLogistics&&freightPrice>0}}">
                    <view class="row-label">商品金额</view>
                    <view class="right-text">¥ {{allGoodsPrice}}</view>
                </view>
                <view class="row-box" wx:if="{{isNeedLogistics&&freightPrice>0&&currentSendType==1}}">
                    <view class="row-label">运费</view>
                    <view class="right-text">+ ¥ {{freightPrice}}</view>
                </view>
                <view class="row-box" wx:if="{{selCouponIndex>0}}">
                    <view class="row-label" wx:if="{{currentCoupon.back_type==1}}">满减券</view>
                    <view class="right-text" wx:if="{{currentCoupon.back_type==1}}">- ¥ {{currentCoupon.deduct}}</view>
                    <view class="row-label" wx:if="{{currentCoupon.back_type==2}}">折扣券</view>
                    <view class="right-text" wx:if="{{currentCoupon.back_type==2}}">{{currentCoupon.discount}}折</view>
                </view>
                <view class="row-box" wx:if="{{deductionBalance&&currentPayType.id==1}}">
                    <view class="row-label">账户余额</view>
                    <view class="right-text">- ¥ {{deductionBalance}}</view>
                </view>
            </view>
            <view class="jiesuan-box">
                <view class="left-price">
                    <view class="total">合计：¥ {{allGoodsAndFreightPrice}}</view>
                </view>
                <button class="to-pay-btn" data-send-type="1" disabled="{{forbidOrder}}" formType="submit" style="background-color: {{forbidOrder==true?'#ccc':themeColor}}">提交订单</button>
            </view>
        </form>
    </view>
</view>
